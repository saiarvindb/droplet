# Redirect all HTTP -> HTTPS
server 
{
	listen 80;
	server_name droplet.eipie.io;

	if ($http_x_forwarded_proto = "http")
	{
		return 301 https://$host$request_uri;
	}

	root /usr/share/nginx/html;
	index index.html index.htm;

	location /
	{
		try_files $uri $uri/ =404;
	}
}

# HTTPS server block
server 
{
	listen 443 ssl http2;
	server_name droplet.eipie.io;

	root /usr/share/nginx/html;
	index index.html index.htm;

	# Cloudflare Origin Cert
	ssl_certificate     /etc/nginx/ssl/droplet.eipie.io/origin.crt;
	ssl_certificate_key /etc/nginx/ssl/droplet.eipie.io/origin.key;

	# Recommended SSL settings
	ssl_protocols TLSv1.2 TLSv1.3;
	ssl_ciphers HIGH:!aNULL:!MD5;
	ssl_prefer_server_ciphers on;

	# Optional: add HSTS (only after youâ€™ve confirmed HTTPS works everywhere!)
	# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

	location /
	{
		try_files $uri $uri/ =404;
	}

	access_log /var/log/nginx/droplet_access.log;
	error_log /var/log/nginx/droplet_error.log;
}
